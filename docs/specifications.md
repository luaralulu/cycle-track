# Menstrual Cycle Tracker – Software Specification

## Overview

A web-based menstrual cycle tracker for visualizing, logging, and predicting period cycles. Built with **TypeScript**, **Vite**, **React**, and **Supabase**. The app supports manual tracking, automated data fill, prediction, and calendar-based display, optimized for both desktop and mobile.

---

## Features

### 🔐 User Authentication (Login Only)

- Only accessible to logged-in users
- App shows **login screen** by default
- User must authenticate via **Supabase email/password login**
- No account creation from the UI
- Credentials are configured via environment or seeded manually
- Once logged in, user session is cached and used for database access

---

### 🔴 Period Logging

- A single **"Log Period"** button
- When clicked:

  - Inserts a new entry for today with:

    - `cycle_day = 1`
    - `period = true`

  - Automatically updates cycle predictions and calendar display

---

### ⏱️ Cron-Based Data Filler

- Runs daily as a cron job
- Checks if **yesterday's** data exists
- If missing, inserts a new row:

  - `cycle_day = last known + 1`
  - `period = true` if `cycle_day` in \[2, 3, 4, 5]
  - `period = false` if `cycle_day >= 6`

- Authenticates with Supabase using email and password from `.env`

---

### 🔮 Prediction Algorithm

- Based on **last 12 cycles**
- Predicts:

  - Next **period** (5 days, starts at next estimated `cycle_day = 1`)
  - **PMS window**: 6–8 days before predicted period start

- Predicted values are marked in the calendar UI

---

### 📅 Calendar UI

- Month grid layout (similar to Flo app)
- Smooth and intuitive animations for:

  - Month transitions
  - Data display updates

- Color coding:

  - 🔴 Red/Pink: Logged or predicted **period** days
  - ⚫ Dark gray with white text: Predicted **PMS** days
  - ⚪ Neutral: All other days

- Each day is editable by clicking

---

## Tech Stack

| Layer            | Technology                                   |
| ---------------- | -------------------------------------------- |
| Frontend         | React + TypeScript + Vite                    |
| Backend/Auth     | Supabase (Auth with email/password)          |
| Cron Jobs        | GitHub Actions                               |
| Styling/UX       | Tailwind CSS or CSS-in-JS                    |
| Calendar Display | Custom grid or library like `react-calendar` |

---

## Database Schema (already exists)

```sql
create table public.cycle_data (
  id bigint generated by default as identity not null,
  user_id uuid not null,
  date date not null,
  cycle_day integer not null,
  period boolean not null default false,
  created_at timestamp with time zone not null default timezone ('utc'::text, now()),
  constraint cycle_data_pkey primary key (id),
  constraint cycle_data_user_id_date_key unique (user_id, date),
  constraint cycle_data_user_id_fkey foreign key (user_id) references auth.users (id)
);
```

---

## Environment Variables

```env
SUPABASE_URL=<your-supabase-url>
SUPABASE_ANON_KEY=<your-anon-key>
SUPABASE_USER_EMAIL=<your-login-email>
SUPABASE_USER_PASSWORD=<your-login-password>
```

---

## Notes

- Must be logged in to access the app
- No registration flow exposed to users
- Should be mobile-friendly
- No offline support or PWA needed at this stage
